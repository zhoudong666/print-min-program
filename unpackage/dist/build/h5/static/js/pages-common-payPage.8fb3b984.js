(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-payPage"],{"591e":function(t,e,a){"use strict";var n=a("914e"),i=a.n(n);i.a},"6f89":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return n}));var n={uniFileList:a("7322").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"pay-page"},[a("v-uni-view",{staticClass:"head my-card padding-20 flex"},[a("v-uni-image",{staticClass:"shop-logo",attrs:{src:t.shopLogo}}),a("v-uni-view",{staticClass:"shop-detail"},[a("v-uni-view",{staticClass:"my-card-header margin-bottom-10"},[t._v("打印点")]),a("v-uni-view",{staticClass:"my-card-content"},[a("v-uni-view",{staticClass:"school fs-30-fw-bold margin-bottom-10"},[t._v(t._s(t.shopName))]),a("v-uni-view",{staticClass:"location"},[t._v("位置: "+t._s(t.shopAddress))])],1)],1)],1),a("v-uni-view",{staticClass:"file-list"},[a("uni-file-list",{attrs:{"file-list":t.payObj.fileOrders,height:"100%"},on:{"change-checked":function(e){arguments[0]=e=t.$handleEvent(e),t.changeChecked.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"page-bottom"},[a("v-uni-view",{staticClass:"my-card padding-20"},[a("v-uni-view",{staticClass:"my-card-content"},[a("v-uni-view",{staticClass:"margin-bottom-10 flex justify-content-between"},[a("v-uni-text",[t._v("总价: "+t._s(t._f("filter2dot")(t.payObj.total))+" 元")]),a("v-uni-text",[t._v("积分抵扣\n            "+t._s(t._f("filter2dot")(t.payObj.deductMerPrice+t.payObj.deductPlatPrice))+"\n            元")])],1),a("v-uni-view",{staticClass:"flex justify-content-between"},[a("v-uni-text",[t._v("应付: "+t._s(t._f("filter2dot")(t.payObj.actualTotal))+" 元")]),a("v-uni-button",{attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoPayBtn.apply(void 0,arguments)}}},[t._v("确认支付")])],1)],1)],1)],1)],1)},s=[]},7322:function(t,e,a){"use strict";a.r(e);var n=a("d93e"),i=a("df63");for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("bd7e");var r,o=a("f0c5"),c=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"0af65d28",null,!1,n["a"],r);e["default"]=c.exports},"7e93":function(t,e,a){"use strict";var n=a("4ea4");a("4160"),a("caad"),a("a9e3"),a("d3b7"),a("2532"),a("159b"),a("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var i=n(a("1da1")),s={onLoad:function(){this.entry=getApp().globalData.isPrintOrCopyOrScan,this.shopName=getApp().globalData.shopName,this.shopCode=getApp().globalData.shopCode,this.shopAddress=getApp().globalData.shopAddress,this.shopLogo=getApp().globalData.shopLogo,this.getPayList(!0)},data:function(){return{entry:"",payObj:{actualTotal:"",deductMerPrice:"",deductPlatPrice:"",deviceMsg:"",deviceName:"",deviceNo:"",fileOrders:[{bastetId:"",fileActualTotal:"",fileDeductMerPrice:"",fileDeductPlatPrice:"",fileName:"",filePath:"",fileTotal:"",price:"",settingDesc:"",totalPages:""}],flowCode:"",shopCode:"",shopLogo:"",shopName:"",total:""},shopName:"",shopCode:"",shopAddress:"",shopLogo:"",deviceMsg:"",timeFlag:!0}},computed:{},methods:{getPayList:function(t){var e=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={flowCode:getApp().globalData.flowCode,deviceNo:getApp().globalData.deviceNo},t?getApp().globalData.basketIds=[]:n.basketIds=getApp().globalData.basketIds,console.log("获取预下单文件信息---params",n),a.next=5,e.$Q.post({url:e.$api("".concat(e.entry,"_confirm")),data:n});case 5:i=a.sent,a.t0=regeneratorRuntime.keys(e.payObj);case 7:if((a.t1=a.t0()).done){a.next=14;break}if(s=a.t1.value,t||"fileOrders"!==s){a.next=11;break}return a.abrupt("continue",7);case 11:e.payObj[s]=i[s],a.next=7;break;case 14:e.payObj.fileOrders.forEach((function(e){e.value=e.bastetId,t?(getApp().globalData.basketIds.push(e.bastetId),e.checked=!0):e.checked=getApp().globalData.basketIds.includes(e.bastetId)})),console.log("获取预下单文件信息",i);case 16:case"end":return a.stop()}}),a)})))()},changeChecked:function(t){this.getPayList(!1)},gotoPayBtn:function(){var t=this;this.timeFlag&&(this.timeFlag=!1,this.gotoPay(),setTimeout((function(){t.timeFlag=!0}),6e3))},gotoPay:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var a,n,i,s,r,o,c,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$Q.post({url:t.$api("".concat(t.entry,"_submit")),data:{deviceNo:getApp().globalData.deviceNo,flowCode:getApp().globalData.flowCode}});case 2:if(a=e.sent,n=a.orderNumbers,Number(t.payObj.actualTotal)){e.next=12;break}return e.next=7,t.$Q.post({url:t.$api("payZero"),data:{orderNumbers:n,payType:0}});case 7:e.sent,uni.showLoading({title:"支付中...",mask:!0}),setTimeout((function(){uni.hideLoading(),t.$goToUrl("/pages/common/waiting",{goType:"redirectTo"})}),500),e.next=22;break;case 12:return e.next=14,t.$Q.post({url:t.$api("pay"),data:{orderNumbers:n,payType:1}});case 14:i=e.sent,i.appId,s=i.nonceStr,r=i.packageValue,o=i.paySign,c=i.signType,d=i.timeStamp,uni.requestPayment({provider:"wxpay",timeStamp:d,nonceStr:s,package:r,signType:c,paySign:o,success:function(e){t.$goToUrl("/pages/common/waiting",{goType:"redirectTo"})},fail:function(t){console.log("fail:"+JSON.stringify(t)),uni.showToast({icon:"none",title:"支付失败,请重试!"})}});case 22:case"end":return e.stop()}}),e)})))()}}};e.default=s},"86ad":function(t,e,a){"use strict";a.r(e);var n=a("7e93"),i=a.n(n);for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"914e":function(t,e,a){var n=a("bfb2");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("9049faa0",n,!0,{sourceMap:!1,shadowMode:!1})},bd7e:function(t,e,a){"use strict";var n=a("f579"),i=a.n(n);i.a},bfb2:function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.pay-page[data-v-32631e00]{height:100%}.pay-page .head[data-v-32631e00]{height:%?160?%}.pay-page .my-card[data-v-32631e00]{background-color:#fff}.pay-page .my-card-header[data-v-32631e00]{color:#0075ff}.pay-page .file-list[data-v-32631e00]{height:calc(100% - %?360?%)}.pay-page .page-bottom[data-v-32631e00]{height:%?200?%;position:fixed;bottom:0;left:0;width:100%}.pay-page .page-bottom .my-card[data-v-32631e00]{height:100%}.pay-page .page-bottom uni-button[data-v-32631e00]{margin:0}.pay-page .shop-logo[data-v-32631e00]{width:%?150?%;height:%?150?%;margin-right:%?10?%}.pay-page .shop-detail[data-v-32631e00]{flex:1}',""]),t.exports=e},c590:function(t,e,a){"use strict";a.r(e);var n=a("6f89"),i=a("86ad");for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("591e");var r,o=a("f0c5"),c=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"32631e00",null,!1,n["a"],r);e["default"]=c.exports},ca88:function(t,e,a){"use strict";a("4de4"),a("c740"),a("caad"),a("d81d"),a("a9e3"),a("2532"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={props:{fileList:{type:Array,required:!0,default:function(){return[]}},height:{type:String,default:"500rpx"}},data:function(){return{isChecked:!0,num:-1}},computed:{items:function(){return this.lastOne(this.fileList),this.fileList}},methods:{checkboxChange:function(t){for(var e=this.items,a=t.detail.value,n=!0,i=a.map((function(t){return Number(t)})),s=0,r=e.length;s<r;++s){var o=e[s];this.$set(o,"checked",i.includes(o.value)),i.includes(o.value)||(n=!1)}this.isChecked=n,getApp().globalData.basketIds=i,this.lastOne(this.items),this.$emit("changeChecked",this.items)},isAll:function(){this.isChecked=!this.isChecked;for(var t=this.items,e=[],a=0,n=t.length;a<n;++a){var i=t[a];this.$set(i,"checked",this.isChecked),this.isChecked&&e.push(i.value)}getApp().globalData.basketIds=e,this.$emit("changeChecked",this.items)},lastOne:function(t){var e=t.filter((function(t){return t.checked}));1===e.length&&(this.num=t.findIndex((function(t){return t.checked}))),e.length>1&&(this.num=-1)}}};e.default=n},d60a:function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.page[data-v-0af65d28]{position:relative;border-top:%?1?% solid transparent;border-bottom:%?1?% solid transparent;width:100%}.page .my-card[data-v-0af65d28]{background-color:#fff}.page .my-card-header[data-v-0af65d28]{color:#0075ff}.page .my-card[data-v-0af65d28]:first-child{margin-top:0}.page .my-card[data-v-0af65d28]:last-child{margin-bottom:0}.page .scroll-container[data-v-0af65d28]{height:calc(100% - %?40?%)}.page .check-all[data-v-0af65d28]{position:absolute;bottom:0;left:0;display:flex;justify-content:flex-end;width:calc(100% - %?40?%)}',""]),t.exports=e},d93e:function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"page",style:{height:t.height}},[a("v-uni-scroll-view",{staticClass:"scroll-container",attrs:{"scroll-y":"true"}},[a("v-uni-view",{staticClass:"gap padding-top-20"}),a("v-uni-checkbox-group",{on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.checkboxChange.apply(void 0,arguments)}}},t._l(t.items,(function(e,n){return a("v-uni-view",{key:e.value,staticClass:"my-card padding-20 margin-20 bd-radius-10",attrs:{id:n}},[a("v-uni-view",{staticClass:"my-card-header"},[t._v("文件列表")]),a("v-uni-view",{staticClass:"my-card-content"},[a("v-uni-view",{staticClass:"flex justify-content-between margin-top-10"},[a("v-uni-text",[t._v(t._s(n+1)+". "+t._s(e.fileName))]),a("v-uni-text",[t._v("￥"+t._s(t._f("filter2dot")(e.price))+" / 张 * "+t._s(e.totalPages))])],1),a("v-uni-view",{staticClass:"flex justify-content-between margin-top-10"},[a("v-uni-text",{staticClass:"fs-32"},[t._v(t._s(e.settingDesc))]),a("v-uni-label",{staticClass:"check-label"},[a("v-uni-checkbox",{attrs:{value:e.value,checked:e.checked,id:n,disabled:t.num==n}}),t._v("选择")],1)],1)],1)],1)})),1),a("v-uni-view",{staticClass:"gap padding-top-20"})],1),a("v-uni-view",{staticClass:"check-all my-card padding-20 display-none"},[a("v-uni-label",[a("v-uni-checkbox",{attrs:{checked:t.isChecked,id:"all"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.isAll.apply(void 0,arguments)}}}),t._v("全选")],1)],1)],1)},s=[]},df63:function(t,e,a){"use strict";a.r(e);var n=a("ca88"),i=a.n(n);for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},f579:function(t,e,a){var n=a("d60a");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("50f436c0",n,!0,{sourceMap:!1,shadowMode:!1})}}]);